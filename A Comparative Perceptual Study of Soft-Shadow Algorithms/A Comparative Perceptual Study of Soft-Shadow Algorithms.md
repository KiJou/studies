---
title: A Comparative Perceptual Study of Soft-Shadow Algorithms [@Hecher2013]
---
# はじめに {#sec:1}

ソフトシャドウのためのリアルタイムアルゴリズムは長年の間リアルタイムレンダリング研究の主要な部門であった。その目標は60フレーム毎秒の時間予算内で物理的なソフトシャドウの外観の*もっともらしい*近似を提供する賢い方法を見つけることである。この成熟した分野において、競合するアルゴリズムの間の差異はしばしば極めて微妙である([@fig:1])。伝統的に、シャドウアルゴリズムは2つ3つの選ばれたシーンで参考解[reference solution]とその出力を比較したり、ピクセル毎の差異を強調したりすることによって評価してきた。さらに、その根拠[authority]を判断する[judge]のは通常シャドウの専門家のグループである。しかし、これは、比較する参考解を持たず、専門家でない、典型的なユーザがシャドウを体験する方法ではない。

![4つの異なるソフトシャドウアルゴリズムでレンダリングされたシーン。その結果は非常に似ているが、そのソフトシャドウ領域において微妙な差異がある。問題は、ユーザがこれらの差異を知覚できるか否か、または、彼らがground truthな解法(GT)をBackprojection(BT)のような物理ベースのリアルタイム近似、または、Percentage-Closer Soft Shadows(PS)やPercentage-Closer Filtering(PF)のような単純な非物理的解法と区別できるかどうかである。](assets/01.png){#fig:1}

このため、与えられるシャドウアルゴリズムが経験済みのユーザ、専門家のユーザ、参考解と共に行う人と比較して*典型的な*ユーザにどれだけ*もっともらしく*見えるか、および、詳しくないユーザが2つの定性的に異なるシャドウアルゴリズムの種類の間の知覚的な差異を*おおむね[in principle]*判断できるか否かを問うことをこの研究の主な動機であった。これらの疑問は様々な関連するシャドウ特性に関して*系統的に*評価しなければならない。特に、我々は、人間の知覚が特定の環境においてソフトシャドウアルゴリズムのある特徴に対してどれだけ*敏感*であるかの疑問を調査しなければならない。

驚くべきことに、シャドウの柔らかさ[softness]を正しく推定する能力(例えば、正しい光条件を判断するために)は、我々の認識では、科学的評価の対象になってこなかった。これは、本質的な奥行きの手がかりとしてのシャドウの重要性や観測者にシーンを現実的に見せる方法が良く知られていることを考慮すれば、かなりの注目に値することである。

この論文の貢献は以下のことである。

- 様々な入念に選ばれたシーンカテゴリの中で物理的な半影のとある重要な特性を近似する能力に関してソフトシャドウアルゴリズムの種類を*体系的に*比較する初めての包括的研究。
- ゲームデザイナや研究者のためのガイドラインとして使われる可能性がある、未経験者、経験者、および、専門家のソフトシャドウの知覚に関する新しい洞察。例えば、物理ベースのモデルに対する全体の優先傾向[preference]はリアルタイムにおいてより高い正確さのために努力すること[striving]が実用的な妥当性[practical relevance]を持つかもしれないことを示す。
- 一般におけるソフトシャドウの研究デザインと見た目のソフトシャドウの実験に関する新たな事実。例えば、異なる質問がソフトシャドウのユーザの判断にどれだけ影響を与え得るか。また、どのシーンカテゴリやソフトシャドウの特徴がソフトシャドウの比較に適しているか、または、どれが適していないか(驚くことに、vegetationのシーンは適していないことが判明した)。

## 研究の範囲と制限 {#sec:1.1}

我々の主な目標は独立変数の管理可能な範囲を探り、ワーストケースのシナリオにおいて徹底的にそれらを調査することであった。特に、我々はソフトシャドウのアルゴリズムが半影の領域の物理的特性をどれだけ上手く捕らえられているかを判断し、半影の差異に可能な限り重きを置く。我々は、それらの半影の近似品質の公正な比較を提示するため、できる限り選ばれたアルゴリズムの低レベルレンダリングのアーティファクトを回避する。アニメーションの計算は、ひとつの研究の範囲内では適切に扱うことが難しいと思われた、追加の自由度を必要とするので、静的なソフトシャドウのみが調査される。我々は、誤ったソフトシャドウの潜在的マスキングを回避するためのシーンのひとつを除いて、すべてでテクスチャを使用しない[@Ferwerda1997]。しかし、我々は、関係する要因に関する展望[outlook]を得るため、我々の研究にテクスチャを伴うひとつの現実的なゲーム型のシーンを含めた。この研究のもうひとつの制限は、各シーンにおいて(そのゲーム型のシーンを除いて)レンダリングされるイメージにおいて可視であった同じ大きさの1つの光源が使われたことである。しかし、光源の異なる大きさや形状はその同じ要因によってシャドウ全体における半影の大きさを変化させ、現在の結果はユーザがシャドウにおける相対的な差異、すなわち、半影の変化の仕方をより良く理解することを示している。

# 研究の概要 {#sec:2}

我々は、ユーザが様々な品質の近似の間の差異を知覚できるか否か、そして、どの程度知覚できるかを明らかにするため、*一対比較[pairwise comparison]の手法*を用いた知覚研究を行った。その実験のもうひとつの目的はソフトシャドウにおけるどの特徴が知覚される品質を大幅に改善するかを解明することである。ソフトシャドウは複合的なライティング現象であるので、比較作業は挑戦的であり、ground truthのリファレンスを示すことによって容易にさせることができる。しかし、ground truthのリファレンスとの比較は人工的な環境[setting]であり、その結果は典型的なユーザのソフトシャドウを判断する能力を恐らく過剰に推定する。一方で、我々はこの作業におけるパフォーマンスがユーザ体験に関する問題ではないかと疑っている。未経験のユーザはソフトシャドウに関する知識を持つ経験者と比べてもっと低い感受性を持っているかもしれない。故に、我々は、*未経験者*、*経験者*、*熟達者[cognizant user]*、と定義した3つのユーザ体験レベルを調査した。これら3つのレベルは各ユーザタイプの振る舞いが3つの連続したフェーズの1つにおいてシミュレートされた所の研究パラダイムによって調査された。初めに未経験であるユーザは学習フェーズを通して経験者になってもらった。そこでは、ground truthのリファレンスが提供された。これらの結果がソフトシャドウレンダリングの本物の専門家とどのように比較されるかを見つけるため、我々はソフトシャドウや大域照明の分野での科学的文献の発表経験を持つ人々を含めて、彼らの結果を非専門的なユーザと比較する。

個々のソフトシャドウ近似の間の差異はかなり微妙である可能性があるので、特に未経験者の知覚では、我々はtwo-option forced-choice comparisonの一般的に使われる概念が*ユーザの整合性[user consistency]*を減少させることによってその研究の情報価値[informative value]を制限し得るという不利益[disadvantage]を持つ可能性があることを発見した。故に、我々は中立的な選択を捨てる[leave]代替の概念を用いる。

# 関連研究 {#sec:3}

## シャドウと照明の知覚 {#sec:3.1}

シャドウの知覚はいくつかの心理学的研究のトピックであった。Wanger et al.はシャドウが物体の空間的関係性に対する重要な見た目の手がかりであることを示した[@Wanger1992; @Wanger_et_al1992]。 @Knill1997 はシャドウが光源の方向とその下地となる表面の形状に関する情報を提供できることを示すことができた。他の研究では物体の接触を知覚するためにシャドウの役割[@Huet2000]や相互反射[@Madison2001]に焦点を当てた。 @Jarabo2012 はジオメトリの複雑さや色のような要因が動的な群衆を伴う仮想シーンにおいて照明の知覚的忠実性にどれだけ影響を与えるかを評価した。

人間の感受性が低い、それ故に、より低品質のシャドウで十分である所の領域におけるソフトシャドウレンダリングを高速化する方法についての以前の研究があった[@Sattle2005; @Vangorp2006; @SchwarzStamminger2008b]。しかし、これらの研究は、特定の種類のアルゴリズムのスケーリングの問題を対処するので、補足的であるのに対して、我々は別個の種類のソフトシャドウアルゴリズムの知覚を比較すること、および、様々なソフトシャドウの特徴を扱うことが知覚的品質を向上させるかどうかに関する研究を提供する。

## 研究デザイン {#sec:3.2}

コンピュータグラフィックスは科学として成熟してきているので、コースティクス[@Gutierrez2008]、トーンマッピング[@Ledda2005]、幾何的な歪み[@SetyawanLagendijk2004]、image-retargetingアルゴリズム[@Rubinstein2010]、大域照明[@Cadik2012]のような包括的な知覚的研究における様々なグラフィクス的効果の利点を評価することの興味はますます高まっている。我々の研究の構造はこれらの研究に本質的に関連し、我々は以下に関する差異、および、類似性を議論する。

@Ledda2005 の実験では、被験者[participant]に対して2つのLCDモニタ上で異なるトーンマッピング操作によって生成されるLDR画像を示し、一方で、参考解としてHDRモニタ上でオリジナルの画像を示した。このアプローチはアルゴリズム処理のパフォーマンスが最適解[optimal solution]に対してテストされなければならず、刺激が[stimulus]どのように見えるべきかを被験者が厳密に知っている所のワーストケースのシナリオをもたらすときに有用である。Ledda et al.とは対照的に、 @Rubinstein2010 の大規模なユーザスタディは参考解を提供*しない*一対比較を用いる。我々の研究において、我々は、まず参考解ありで行い、その後、参考解なしで行うという*両方*のシナリオを含める。そして、これらを用いてソフトシャドウアルゴリズムを評価するためのユーザの専門知識の異なる度合いを模倣する。これは、大域照明とレンダリングのアーティファクトの検出のために画像品質メトリクスを計算する、 @Catik2012 と同種のものである。これらの2つのフェーズに加えて、我々はもうひとつの研究フェーズにおいて参考解を示してから達成される学習効果を研究する。また、参考解なしでも行う。

レンダリング手法の知覚を研究するための興味深い代替手法は、もっともらしい大域照明を生成するために可視性の計算において必要となる正確性を調査した @Yu2009 によって用いられた。彼らはいわゆる*paired comparison plus category* [@Scheffe1952]のパラダイムを用いた。好み[preference]を答えるのではなく、参加者は類似性の高低を範囲とする事前に定義されたカテゴリの尺度で2つの画像の*類似性*を採点した。我々の研究でも同様に類似性の推定を得るため、我々は評価に中立的な回答の数を組み込む。

@SetyawanLagendijk2004 は一人の被験者の回答の質とすべての被験者の間の合意を解析する。我々は被験者のパフォーマンスや学習フェーズが効果的だったかどうかを評価するために我々の研究にこの概念を採用した。 @Akyuz2007 に従って、我々は、有意差を計測できず、それ故に、匹敵する品質であると判断したアルゴリズムのグループを見つけるためにTukeyのHSD法[@Steel1997]を用いる。その成果[outcome]に関して実験の効果をより良く評価および理解するため、我々は*degree of indifference*と表記する新しい量を導入し(詳細は[@sec:7]で説明される)、一対比較の結果から*worth parameters*[@HantzingerDittrich2012]を計算する。

# 選ばれるソフトシャドウアルゴリズム {#sec:4}

リアルタイムにおいてソフトシャドウを近似する多種多様なアルゴリズム[@Eisemann2011]のため、適切なサブセットの選択はこの研究の準備において重要なプロセスである。一方で、我々の目的は単純な経験則的手法から高コストだが完全に物理的な手法までの範囲全体を取り扱う[cover]ことであった。他方で、我々はひとつの研究で調査するのに適したアルゴリズム数に制限しなければならない。我々は、利用可能な可視性情報を用いて物理的シャドウの現実的な半影を近似する能力に関する、リアルタイムソフトシャドウアプローチの*代表的な種類*を形成する3つのアルゴリズムを選択し、そして、比較のためにブルートフォースのground truthの解を追加する。我々はリアルタイムソフトシャドウレンダリングに対して実践で使われるほとんどの手法がこれらの基本形式のバリエーションかある種の*アーティファクト*を隠すことを目的とする調整版であると主張する。また、すべての主要なリアルタイムアプリケーションにおけるこれらの優位性[predominance]のため、シャドウマッピングに基づくアルゴリズムのみが考慮された。すべての我々のアルゴリズムの見た目の比較は[@fig:2]で確認できる。

![ソフトシャドウアルゴリズムの見た目の比較。クローズアップは、ヒューリスティクスによって誤魔化す[fake]のが最も難しく、それ故に、シャドウアルゴリズム間の見た目の差異のほとんどを占める、*penumbra softening*と*penumbra overlap*の2つの特性を示している。拡大された画像のコントラストは差異をより良く可視化するために調整されたことに注意する。](assets/02.png){#fig:2}

我々は*overshadowing*や*staircase artifacts*のようなアーティファクトを回避することを決めた。これは、それらの存在が結果として前述のテストにおいてアーティファクトフリーな画像に対する明らかな優先傾向となるためである([@fig:3]を参照)。用いられるアルゴリズムは以下である。

![アーティファクトのあり(a)となし(b)のシーンにおいてアルゴリズムを選択する確率。アーティファクトがない場合には著しく異なる結果を引き起した。拡大された画像のコントラストは差異をより良く可視化するために調整されたことに注意する。](assets/03.png){#fig:3}

Percentage-Closer Filtering (PF)
: PFは二値のシャドウマップテストの結果をフィルタリングすることによるハードシャドウの境界に対するアンチエイリアシング手法として導入された[@Reeves1987]。しかし、これは適切なフィルタカーネルの大きさを設定することによってソフトシャドウの半影領域をシミュレートするためにも用いることができる。しかし、カーネルの大きさは大局的なパラメータであり、局所的な半影の大きさを変化させられないので、その手法は[@fig:2]aに示されるように*penumbra softening*を再現[reproduce]できない。これは安価な非物理的アルゴリズムであり、我々が期待するのは、それが研究において最も物理的にもっともらしくないものとして現れるであろう、ということである。

Percentage-Closer Soft Shadows (PS)
: PS[@Fernando2005]は、半影の大きさが光源からレシーバーおよびブロッカージオメトリまでの相対距離に基づいてフラグメントごとに動的に計算される、というPFの拡張である。これは光源からのブロッカージオメトリまでの距離を近似するために単一のシャドウマップを用い、それ故に、単サンプルのソフトシャドウアルゴリズムとして知られている。この単純な経験則的モデルは半影の大きさの変化を計算に入れるが、そのアルゴリズムの非物理的性質はsoftness overlapの異なる度合いを持つ半影の領域において問題を引き起こす([@fig:2]b)。
  最近の手法はtemporal coherenceを伴うPSを組み合わせることによってより高品質を達成する[@Schwarzler2013]。ただし、これはcoherenceが破綻しない場合に限ってのみ完璧に機能する。

Backprojection (BP)
: Backprojection[@Atty2006]はシャドウマップから小さなblocker patchesを識別し、それらを光源にbackprojectingすることによってそのシーンにおけるある点に届く光の量を推定する。この手法は可視性が単一のサンプルを用いてのみ推定されるという事を除いて物理ベースである。そのアルゴリズムはより単純なPS手法よりも正確に複合的なpenumbra overlapと半影の大きさの変化の両方を扱うことができる。残念ながら、BPはライトリークとovershadowingアーティファクト(すなわち、半影が若干暗くなりすぎる可能性がある)を起こす傾向がある。我々は、overshadowingアーティファクトを引き起こさないためでもある、慎重に選択されたパラメータでライトリークを減らすために、gap-fillingアプローチ[@Guennebaud2006]を用いることを選んだ。
  BPをより堅牢にすることを目標に持ついくつかの手法がそれ以来発表されてきたが、通常は単サンプルのアーティファクトを緩和していることに注意する。しかし、これらすべては複数のシャドウマップレイヤ[@SchwarzStamminger2008a; @Bavoil2008]、または、複数視点からのシャドウマップサンプル[@Yang2009]における複合的な可視性計算のコストを伴い、改善された正確性に対するリアルタイム要件を本質的に緩和させる。

  Ground Truth (GT)
  : 我々は参考解として、範囲光源を複数回サンプルし、その後、結果のシャドウマップと一緒にブレンドする、ブルートフォース手法を用いる。この手法は十分な数のポイントライトに対して物理的なground truthに収束するので(大域照明効果を無視して)、我々はこれをこの研究の範囲内でground-truth解と呼ぶ。我々の実験において、その解は1024サンプル以降に収束した(すなわち、それ以上のピクセル強度の変化がなかった)。このアプローチは低速であるが、overlappingアーティファクトなしに正しいpenumbra softeningを生成する。

これらの手法のそれぞれが達成できる近似品質は根本的に異なり、PFからGTの順に増加する。PFは均一な半影をモデル化することだけが可能であるが、PSは局所的な*半影の大きさの変化*に対する能力を持つ。BPは、光源の遮蔽率[coverage]の積分の正確な物理モデルを用いるので、*物理ベース*の半影を計算することによってさらに一歩先を行く。GTは1024サンプルが用いられるときに現実解[real solution]に収束するという意味において*物理的に正確[physically correct]*な半影を計算する。アルゴリズムの能力のまとめに関しては[@tbl:1]を参照のこと。

||半影の大きさの変化|物理ベースの半影|物理的に正確な半影|
|:-:|:-:|:-:|:-:|
|PF|--|--|--|
|PS|$\checkmark$|--|--|
|BP|$\checkmark$|$\checkmark$|--|
|GT|$\checkmark$|$\checkmark$|$\checkmark$|
: この研究において調査されるアルゴリズムによってサポートされるソフトシャドウ近似に対する能力。 {#tbl:1}

# シャドウ知覚の独立変数 {#sec:5}

TODO

# 7 {#sec:7}

# #27 --- Russian Roulette Path Termination

## トレースの打ち切り

Q: どのタイミングでトレースを打ち切るべきか？

A: ある程度バウンスしたら打ち切る。

とはいえ、打ち切られた分のエネルギー損失が発生することで結果に影響を与えるので、この方法は片手落ち感が否めない。
そもそも、レンダリング方程式を解くには無限回のバウンスが必要であるため、どこで打ち切ってもエネルギー損失は発生してしまう。

そこで、期待値において、推定値が真値に収束するような確率論的手法を考える。
これは、$i$回目の後にトレースを継続するかどうかの確率$p_i$を導入するとき、統計的に正しくするために集めた放射輝度に$\frac{1}{p_i}$をかけることで達成できる。

\[
E[\hat L_i] = p_i \cdot \frac{L_i}{p_i}  + (1 - p_i) \cdot 0 = L_i
\]

では、$p_i$はどのようにして決定すればよいだろうか。
経路が持ち得るエネルギー量を考えれば、明るい経路が暗い経路よりも長くなるようにすればよいので、アルベドを用いるのが適切な方法の１つであると言える。

## 参考文献

- http://rayspace.xyz/CG/contents/path_tracing.html
- http://rayspace.xyz/CG/contents/MC_others.html

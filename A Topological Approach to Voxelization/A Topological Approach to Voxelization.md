# まえがき[Introduction]

TODO

## 基本的定義[Basic definitions]

我々の表記法は主にCohen-Or and Kaufman[@COK95]に従う。整数の座標を持つ3次元の点の集合を$\mathbb{Z}^3$する。我々は点$p(x, y, z) \in \mathbb{R}^3$の集合とボクセル$V = (x, y, z) \in \mathbb{Z}^3$を関連付ける。ここで、$V_x \le p_x \le V_x + 1$であり、$y$と$z$に対して同様である。$\mathbb{R}^3$に組み込まれた連続で単純で閉じた2次元多様体の表面$S$を考えるとすると、$\mathbb{R}^3 - S$は過不足なく[exactly]2つの連結成分[connected components]$I$および$O$を持つ。$I$と$O$の全体に含まれるボクセルの空でない集合をそれぞれ$I^d$と$O^d$とする
表面$S$のボクセル化とは$I^d$や$O^d$と共通の要素を持たないボクセルの離散集合$S^d$である。ボクセルの$k$連結経路[k-connected path]$\Pi_k = (V_0, \dots, V_n)$が存在しないならば、$S^d$は$k$分離[k-separating]であると言われる。ここで、$V_{i + 1} \in N_k(V_i)$、すなわち、$V_0 \in I^d$であり、$V_n \in O^d$であり、$\Pi_k \cap S^d \ne \emptyset$である。別の言い方をすれば、$I^d$と$O^d$の間のすべての$\Pi_k$が$S^d$にあるボクセルを含むならば、$S^d$は$S$の$k$分離ボクセル化である。$N_k(V)$はボクセル$V$の$k$近傍の集合であり、$\mathbb{Z}^3$において、我々にとって関心のある近傍集合は以下である。

$$
N_6(x, y, z) = (x \pm 1, y, z) \cup (x, y \pm 1, z) \cup (x, y, z \pm 1)
$$

$$
N_{26}(x, y, z) = {x - 1, x, x + 1} \times {y - 1, y, y + 1} \times {z - 1, z, z + 1} - (x, y, z)
$$

ここで、$\times$はデカルト積[cartesian product]を表す。ゆえに、任意の$V$に対して、$N_6(V)$は6個の要素を持ち、$N_{26}(V)$は26個の要素を持つ。したがって、6連結経路$\Pi_6$はボクセルの面を通って隣接するボクセルをたどる[walk into]ことができるのみであり、26連結経路$\Pi_{26}$ではそれに加えて[as well]対角線上にたどること[diagonal walks]が可能である。紙面の都合により[due to space constraints]、本論では18分離および18連結のボクセル化および経路を考えない[we shall not consider]。
2Dボクセル化においても状況は変わらず、この場合においては、我々はそれらに対応する意味で$S \subset \mathbb{R}^2$、$S^d \subset \mathbb{Z}^2$、$V$、$I$、$O$、$\Pi_k$を用いる。その次元は文脈により明らかとなるだろう。2Dにおける近傍関係[neighborship relations]は以下である。

$$
\begin{aligned}
N_4(x, y) &= (x \pm 1, y) \cup (x, y \pm 1) \\
N_8(x, y) &= {x - 1, x, x + 1} \times {y - 1, y, y + 1} - (x, y)
\end{aligned}
$$

ここで、$N_4$は3Dにおける$N_6$と類似し、$N_8$は$N_{26}$と類似している。近傍集合の図は、例えば、[@HYFK98]に見ることができる。
我々は、その表面が依然として$\mathbb{R}^3$において対応するボリュームを2つの連結成分に分けるようなボクセル空間$\mathbb{Z}^3$の部分集合を考慮することによって、閉じていない表面に分離可能性[separability]の概念を拡張できる。これについては[@fig:1]を参照のこと。閉じている表面と閉じていない表面のどちらでも、対応する$I^d$および$O^d$が空でない場合に制限していることに注意したい。そうでない場合、$\mathbb{Z}^3$で分離する手段が存在しないので、分離可能性を論じる意味がなくなってしまう[it makes no sense to speak of separability]。

![閉じていない表面への$k$分離可能性の概念の拡張。（a）$S$が依然として$\mathbb{R}^3$における対応するボリュームを2つの連結成分$I$および$O$に分離するような部分集合$\boldsymbol{z} \subset \mathbb{Z}^3$が存在する閉じていない表面$S$を考える。そして、対応する$I^d$および$O^d$は空ではない。（b）$\boldsymbol{z}$におけるボクセルに制限される$I^d$と$O^d$の間のすべての$\Pi_k$が$S^d$におけるボクセルを含むならば、$S^d$は$S$の$k$分離ボクセル化であると言える。そして、これは部分集合$\boldsymbol{z}$の任意の有効な選択に対して成り立つ[holds for]。この2Dの例では、$S^d$は8分離ではなく4分離である。](fig/1.png){#fig:1}

# 関連研究[Previous work]

TODO

# 交差対象を伴うボクセル化[Voxelizing with intersection targets]

我々の手法では、入力ジオメトリが$V$の中に含まれる*交差対象[intersection target]*と交差するかどうかのテストによって、ボクセル$V$がボクセル化$S^d$に含まれるかどうかを選択する。すべての場合において、$S$のsupercover[@COK95]に属するボクセルを考えるには、それとは別のボクセルにおける交差対象が明らかに入力ジオメトリと交差できないので、これで十分である。
本節の後半において、我々は、入力の実効次元がボクセル化戦略に与えるであろう影響度と退化した交差を扱う一般的な方法を考察する。[@sec:4]では、2Dにおける曲線に対する交差対象を導出し、[@sec:5]では、3Dにおける曲面および表面のボクセル化を検討する。最後に、[@sec:6]では、交差対象がボクセルごとに異なっても良い変種[variants]を調査する[examine]。

### 入力の実効次元[Effective dimension of input]

交差対象は様々な次元のプリミティブから構成しても良い。これらの例については[@fig:4]を参照のこと。交差対象の次元の適切な選択はその入力の*実効次元[effective dimension]*に依存する。これは入力プリミティブの次元と異なっても良い。例えば、ソリッドな円柱としてジオメトリ的に表現される1本の細い髪の毛[strand of hair]を考えよう。その物体がボリューメトリックな立体であるとしても、例えば、ボリューム内に点があるかどうかの単純なテスト[simple point-in-volume test]を用いてボクセル化するという発想はおそらくうまくいかない。これは我々の用語法においてボクセルの中心にある0次元の点である交差対象と対応するだろう。入力が実質的に1次元であり、交差対象が0次元であるので、交差は髪の毛の太さに依存する任意に小さな確率でのみ発生する。これは結果としてその入力を代表しないボクセル化となり、例えば、その連結性[connectivity]を維持することができない。

![色々な種類の入力に適する、様々な次元のプリミティブから構成される交差対象の例](fig/4.png){#fig:4}

この例の状況において、例えば、$S^d$に対する6または26連結性を立証したい[want to establish]場合、入力と交差対象との交差が確率で決まらないようにする[not rely on chance]ため、我々は少なくとも2次元の交差対象を用いなければならない。一方で、3次元の交差対象（例えば、ボクセル全体）は不必要に鈍く[unnecessarily blunt]、結果として冗長なボクセルが$S^d$に含まれてしまう可能性があるだろう。髪の毛が3Dの立体、2Dの表面、1Dのポリライン[polyline]または曲線のいずれかから構成されるかに関わらず同じ論拠[argument]が適用される。すなわち、実効次元は入力プリミティブの次元より関連性がある[relevant]。
2Dボクセル化において、2Dプリミティブの列が実質的に1次元である物体を形成するとき、似た状況が発生する。そのような例のひとつは、パスレンダリング[path rendering]で一般的な状況である、ゼロでない小さな太さを持つ線分から構成される曲線である。通常の0次元の交差対象（ピクセルの中心）によってパスをラスタライズすることはその結果の連結性を保証できないが、各ピクセル内に適切な1D交差対象を配置することによって、4または8連結性のいずれかを容易に保証することができる。また、完全な2D交差対象はこれらの目的に対して過剰であるだろう。
関連研究[previous literature]で示される手法は入力プリミティブの次元性[dimensionality]に対して厳密に特殊化されるため、実効次元より（不必要に）高いプリミティブの次元が発生する入力には適用できない。例えば、その入力が実質的に1次元であると分かったとしても、線のボクセル化アルゴリズムは2Dの表面から構成される細い髪の毛に対して使用できない。我々の交差対象手法はこの問題に悩まされず、同じ枠組みの中で任意の次元のプリミティブから構成される入力を扱うことができる。

## 退化した交差[Degenerate intersections]

入力プリミティブと交差対象の境界は、ボクセル化において本来不要な穴[spurious holes]を生成するのを避けたり、不必要な「厚い」結果を避けたりするため、正確に扱われなければならない。交差において境界（ボリュームの表面、三角形のような表面要素の辺、線の端点、または、曲線の線分）を常に含めることは穴を形成することを防ぐだろうが、入力が複数の交差対象の境界に触れるとき、対応するボクセルのすべてが$S^d$に含まれる。Cohen-Or and Kaufman [@COK95]は詳細に[at length]これらの問題を考察し、慎重に選択された2Dピクセルまたは3Dボクセルの境界部分が除外される交差対象を用いることを提案する。
このような手法はより複雑な交差対象に拡張することが難しく、それ故に、我々は退化した交差の問題に対するより汎用的でより単純な解法を提案する。我々はまず、任意のそのような退化がどちらかの入力ジオメトリを --- または、等価的に、交差対象を --- 適切な方向に若干摂動させることによって解決することができることを述べる[observe]。これは結果として、交差していないか、入力と交差対象が適切に交差しているかのどちらかとなる。ここでは境界が含まれているかどうかは問題とならない。
入力プリミティブと交差対象の間の任意の退化を取り除く微小摂動ベクトルを*演繹的に[a priori]*選択できるということが判明する。この摂動を入力全体に --- または、等価的に、すべての交差対象に --- 適応することは入力に対する微小の修正[modifications]が許可されると仮定して正しいボクセル化を生成する。そのような摂動ベクトルの例は$(\epsilon, \epsilon^2, \epsilon^3)$である。実践において、退化した交差は、退化していない結果が得られるまで、まずは$+x$へ、そして$+y$へ、などというように、微小に入力（または、交差対象）をずらすことで退化していない状態になるかどうかをテストすることによって解決される。
ボクセル対三角形やピクセル対辺のテストでは、このアプローチはCohen-Or and Kaufman [@COK95]の"reduced-voxels"と等価であるが、ボクセル境界の面、辺、頂点について、どれが含まれ、どれが外されるかを個別に選択する必要がない。標準の2Dラスタライゼーションで用いられる点対三角形のテストでは、一般的なグラフィックスAPIで使われるラスタライゼーション規則と等価である。これは、一貫した面の向き[consistent facing]を持つ三角形の扇が各ピクセル中心を、それが辺や頂点の上にあったとしても、たった一度だけ[exactly once]含める[cover]ことを保証する。実践において、我々は微小摂動ベクトルのアプローチが通常では交差計算中に行われる不等式テストの中へ注意深く配置された方程式に煮詰まる[boil down]ことを期待する。例えば、3Dでのポリゴン対ポリゴンのような、とあるテストでは、その実装は自明ではないかもしれない。
ほとんどの場合、退化した交差が発生するような稀なケースにおいて結果のボクセル化に少量の余分なボクセルを含むことはそこまで悲惨というわけではない[not disastrous]ことは記されるべきである。入力プリミティブと交差対象が互いに触れているだけでも交差を報告する保守的な[conservative]交差はボクセル化に加えることだけが可能であり、それ故に、その連結性や分離可能性の特性を一切破壊しない。薄さは妥協して解決される[compromised]かもしれず、これが関心事であるかどうかはアプリケーションに依存する。摂動手法の主な価値[principal value]は潜在的な退化を考える必要性を取り除くことによって我々の解析を単純化することである。

# 2Dにおける交差対象[Intersection targets in 2D]

まずは2Dにおけるボクセル化、すなわち、ラスタライゼーションを考えるとしよう。一般的な命名法[nomenclature]に従うため、***

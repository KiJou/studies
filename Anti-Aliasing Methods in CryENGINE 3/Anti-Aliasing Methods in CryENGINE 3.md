---
title: Anti-Aliasing Methods in CryENGINE 3 [@Sousa2011b]
numberSections: false
---
# CryENGINE 3のAA要件[CryENGINE 3 AA Requirements]

- 直交で一般的なソリューション
    - プラットフォーム毎のAAソリューションではない
- HDR/ディファードテクニックでうまく働く。
- サブピクセルの正確さが我々にとって重要である。
    - Schimering^[shimmeringの誤字？]はCrysis1と2のレベルでは最も不快なものであった。
    - Crysisは、アルファテストされる/極小のサブピクセルのディテールのような、エイリアスするアセットを大量[imensively]^[immensivelyのtypo？]に持っている。
    - HDRはライティングコントラスト/色変化の大きな範囲でさらに悪くする。
- 低メモリフットプリント
- ローエンドGPUで2ms以下のコスト
    - Every ms counts for consoles

# 今世代ハードウェアでのMSAAの悩み[MSAA Troubles for this HW Generation]

- メモリが必要
    - 2x、4x、など
- マルチプラットフォーム＋昔ながらでないレンダリング[@Sousa2011]
    - PS3ではFP16をサポートしていない。(アルファブレンディングパス用)
    - X360の10MBのEDRAM＋タイリング＋解決コストオーバーヘッド
    - アルファテストAAはATOCが必要
- トーンマッピングはサブサンプルごとに処理されるべき。
    - でなければ、高コントラストの領域で目立つ間違った結果になる。
    - 昔のプラットフォームには高価すぎる。

多数のワークアラウンドと追加された複雑さ
各々のソリューション、ワークアラウンド、最適化を持つ各プラットフォーム
パフォーマンスコスト

現世代では、こんな状況でやっていける見込みはない。

最小のGバッファ
    RGBA8 ワールド空間の背面の法線＋光沢度[glossiness]
    リードバックD24S8 深度＋屋内エリアのタグ付け用ステンシル
ディファードライティングバッファ
    Xbox360: パフォーマンス/メモリのためにRGB10A2に解決される2つのRGB10F
    PS3: 不透明ではRGBKにエンコードされるRGBA8、透明ではFP16
    PC: FP16

X360: 28MB; PS3 31.5MB; PC: 720pで49MB、1080pで110MBなど

# テンポラルアンチエイリアシング(別名、モーションブラー)[Temporal Anti-Aliasing (aka Motion Blur)]

- スクリーン空間の速度ベクトルに沿った方向ブラー[@Green2003]
    - ピクセルまたは頂点あたりの前/現スクリーン空間の位置からのデルタ
    - イメージ空間のモーションブラー
- 主な利点: 移動中の目立つエイリアシングが少ない。

Crysis1やKillZone2以来、人気を増している。
スクリーン空間の速度ベクトルに沿った方向ブラーとして近似される。
    ピクセルまたは頂点あたりの前/現スクリーン空間の位置からのデルタ
追加ボーナス: 素晴らしい映画的なルック

すべてのプラットフォームで使える。

# Aバッファ SSAA[@Haeberli1990][A-Buffer SSAA[Haeberli90]]

- サブピクセルジッターをカメラ錐台に加える。
- ブルートフォース: 複数回シーンをレンダリングする。
    - N個のサブサンプル ⇔ N回のシーンレンダリング
- ロバストで最高品質
    - SSAA以外の用途でも(TSSAA/DOF/ソフト・シャドウ)。
- 基本の概念が我々のテクニックで使われている。
- 問題: 複数回シーンをレンダリングする余裕が(まだ)取れない。
    - それでも、リファレンス/マーケティングクオリティのショットとしては素晴らしい

あるいは、高解像度でレンダリングしてダウンスケールする通常のアプローチ

# フレームを越えてAバッファ SSAAを分散する[Distribute A-Buffer SSAA Overframes]

- 60fpsで動作する？
    - 毎フレームにカメラ錐台にサブピクセルジッターを加える。
    - 前/現フレームを格納して、線形ブレンドする。
    - 光速の2xSSAA: 現在のコンソールで約0.5ms
    - 2フレーム ⇔ 2xSSAA、4フレーム ⇔ 4xSSAA、など
- しかし、コンソールで60fpsに達することはほとんどない。
    - fpsが低いと、結果として極めて目立つ画像ゴーストになる。

ごく一部の昔の60fpsのゲームで使われた(DMC4？)けど、だれが最初だっけ？

60fpsでもゴーストは目立つ。

# アーティファクトの最小化[Minimizing Artifacts]

TODO

---
title: >
Decima Engine: Advances in Lighting and AA [@Carpentier2017]
numberSections: false
---
# デシマエンジン[Decima Engine]

コイツが何なのか知らない人たち用:
Decima EngineはKillzoneシリーズのためにGuerrilla Gamesによって作られたゲームエンジンである。
しかし、より大きくより美しい世界をサポートするため、それ以来拡張と最適化を行い続けた。そこには、Horizon Zero Dawnのそれも含まれる。
そして近年、コジマプロダクションとのDecima Engineの共有も始まり、彼らは現在それをDeath Strandingの開発に用いている。

# トピックス[Topics]

- GGXの球エリアライト
- 高さフォグ
- 1080pにおけるAA
- PS4Proでの2160pチェッカーボード

# GGX球エリアライト[GGX spherical area light]

- 形状上でGGXを積分するのは難しい。
- 様々な近似アプローチ
    - パフォーマンス vs クオリティ
    - 形状固有(例えば、多角形ライトの[@Hill2016])
- 球ライトでは: ポイントライトを'たわませる[warp]'安価なトリック[@Karis2013]
    - 歪みを引き起こし得るが、改善できる。

Decima Engineは恐らくエリアライトを用いるライティングをサポートする最初のゲームエンジンのひとつであった。
ただし、初期の実装はGGXをサポートしておらず、我々を制限する要因となっていた。
そこで、最近エリアライトシステムをアップグレードし始め、まずは我々の球エリアライトにGGXを追加しようとした。
しかしながら、GGXのようなマイクロファセットBRDFをエリアライトに統合することは難しく、ある種の近似的なテクニックを必要とする。
実際に、まさにそれを行うためにいくつかの異なるテクニックがここ数年で出現してきた。これらのテクニックのいくつかはパフォーマンスよりクオリティを優先しており、いくつかはその逆を優先している。そして、これらのテクニックの多くは形状タイプのただひとつに対して特に適するようになっている。我々の新しい球エリアライトでは、色々と調べた結果、Brian Karisによって述べられるライト曲げ[bending]トリックを選択することとした。
これは安価であり、多くの様々なゲームエンジンで上手く使われている。
そして、その結果はしばしばかなりまともである。
しかし、特にグレージング角で、予期せぬ形状が現れることがある。
左側の画像でそれをはっきりと確認することができる。しかし、我々はそのテクニックを改善する方法をひとつ見つけ、右側の画像に見えるものがそれである。では、これはどうやって動作するのだろう？

# GGX球エリアライト[GGX spherical area light]
<!-- p.6 -->

- どうやってピクセルあたり1つのポイントライトを用いてエリアライトを近似するのだろう？

まずはBrian Karisのテクニックを調べることから始めよう。その発想は単一のポイントライトで右図のような結果を近似したいということである。
そして、反射ベクトルの方向でエリアライトの周長[perimeter]に向かってポイントライトを動かすことでそれを行うことができる。

# GGX球エリアライト[GGX spherical area light]
<!-- p.7 -->

- ピクセルの反射ベクトルに向かってポイントライトを動かすことで[@Karis2013]
    - Phongモデルに対して素晴らしい[@Picott1992]
    - マイクロファセットモデルではあまり良くない。依然としてピーク応答を'取り逃がす'可能性がある。

これはPhongベースのライティングではとてもうまく動作し、1992年にはすでに述べられていた。
しかし、GGXのようなマイクロファセットベースのモデルではそのように常にうまく動作するわけではない。
これはポイントライトに対して選択される位置が最も支配的な影響を常に上手に代表するわけではないためである。

言い換えれば、ここでの一般的なアイデアはピクセルにピークを持ち込むことであるが、この方法だとピクセルは依然としてピークを取り損なう可能性がある。

# GGX球エリアライト[GGX spherical area light]
<!-- p.8 -->

- アイデア: **その応答を最大化する** ために周長上でポイントライトを動かす。
    - 支配因子: $N \cdot H$

TODO

# 参考文献[References]
